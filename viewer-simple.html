<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIB34D Viewer - Mathematical Art</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #000; 
            color: #fff; 
            font-family: 'Arial', sans-serif;
            overflow: hidden;
        }

        /* Full Screen Layout */
        .viewer-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Top Bar */
        .top-bar {
            background: rgba(0,0,0,0.8);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            z-index: 100;
        }

        .creation-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff0080;
        }

        .creation-stats {
            display: flex;
            gap: 2rem;
            align-items: center;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Main Canvas Area */
        .canvas-container {
            flex: 1;
            position: relative;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .main-canvas {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Floating Controls */
        .floating-controls {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 1rem;
            background: rgba(0,0,0,0.8);
            padding: 1rem 2rem;
            border-radius: 50px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .control-btn {
            padding: 0.8rem 1.5rem;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 25px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .control-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .control-btn.primary {
            background: linear-gradient(135deg, #ff0080, #ff8c00);
            border: none;
        }

        .control-btn.primary:hover {
            box-shadow: 0 10px 20px rgba(255,0,128,0.3);
        }

        /* Side Panel (Hidden by default) */
        .side-panel {
            position: fixed;
            right: -300px;
            top: 0;
            width: 300px;
            height: 100vh;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(255,255,255,0.2);
            padding: 2rem;
            transition: right 0.3s ease;
            z-index: 200;
            overflow-y: auto;
        }

        .side-panel.open {
            right: 0;
        }

        .panel-section {
            margin-bottom: 2rem;
        }

        .panel-section h3 {
            color: #ff0080;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .param-control {
            margin-bottom: 1rem;
        }

        .param-control label {
            display: block;
            margin-bottom: 0.5rem;
            color: #40e0d0;
            font-size: 0.9rem;
        }

        .param-slider {
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
            outline: none;
            -webkit-appearance: none;
        }

        .param-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #ff0080;
            border-radius: 50%;
            cursor: pointer;
        }

        /* Creator Info */
        .creator-info {
            position: absolute;
            top: 50%;
            right: 2rem;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.8);
            padding: 1.5rem;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            max-width: 250px;
            opacity: 0;
            animation: slideInRight 0.8s ease 2s forwards;
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateY(-50%) translateX(50px); }
            to { opacity: 1; transform: translateY(-50%) translateX(0); }
        }

        .creator-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff0080, #40e0d0);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .creator-name {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #ff0080;
        }

        .creation-description {
            font-size: 0.9rem;
            opacity: 0.8;
            line-height: 1.4;
            margin-bottom: 1rem;
        }

        .follow-btn {
            width: 100%;
            padding: 0.8rem;
            background: linear-gradient(135deg, #ff0080, #40e0d0);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .follow-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255,0,128,0.3);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .top-bar {
                padding: 1rem;
                flex-direction: column;
                gap: 0.5rem;
            }

            .creation-stats {
                gap: 1rem;
                font-size: 0.8rem;
            }

            .floating-controls {
                bottom: 1rem;
                padding: 0.8rem 1rem;
                gap: 0.5rem;
            }

            .control-btn {
                padding: 0.6rem 1rem;
                font-size: 0.8rem;
            }

            .creator-info {
                position: static;
                transform: none;
                margin: 1rem;
                animation: none;
                opacity: 1;
            }

            .side-panel {
                width: 100vw;
                right: -100vw;
            }
        }

        /* Loading State */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 50;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid #ff0080;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="viewer-container">
        <!-- Loading State -->
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p>Loading your mathematical masterpiece...</p>
        </div>

        <!-- Top Bar -->
        <div class="top-bar">
            <div class="creation-title" id="creation-title">Quantum Dreams #1234</div>
            <div class="creation-stats">
                <div class="stat">
                    <span>üëÅÔ∏è</span>
                    <span id="view-count">2,847</span>
                </div>
                <div class="stat">
                    <span>‚ù§Ô∏è</span>
                    <span id="like-count">156</span>
                </div>
                <div class="stat">
                    <span>üîÑ</span>
                    <span id="share-count">23</span>
                </div>
            </div>
        </div>

        <!-- Main Canvas -->
        <div class="canvas-container">
            <canvas class="main-canvas" id="main-canvas" width="1920" height="1080"></canvas>
        </div>

        <!-- Creator Info -->
        <div class="creator-info">
            <div class="creator-avatar">üé®</div>
            <div class="creator-name">@mathartist</div>
            <div class="creation-description">
                A mesmerizing blend of quantum mechanics and geometric beauty. Created with Faceted system using golden ratio proportions.
            </div>
            <button class="follow-btn">+ Follow Creator</button>
        </div>

        <!-- Floating Controls -->
        <div class="floating-controls">
            <button class="control-btn" onclick="toggleLike()">
                <span id="like-icon">ü§ç</span>
                Like
            </button>
            <button class="control-btn" onclick="shareCreation()">
                üì§ Share
            </button>
            <button class="control-btn" onclick="remixCreation()">
                üé≠ Remix
            </button>
            <button class="control-btn primary" onclick="createOwn()">
                ‚ú® Create Your Own
            </button>
            <button class="control-btn" onclick="togglePanel()">
                ‚öôÔ∏è Settings
            </button>
        </div>

        <!-- Side Panel -->
        <div class="side-panel" id="side-panel">
            <div class="panel-section">
                <h3>üé® Current Parameters</h3>
                <div class="param-control">
                    <label>Hue: <span id="hue-display">180</span>¬∞</label>
                    <input type="range" class="param-slider" id="hue" min="0" max="360" value="180" disabled>
                </div>
                <div class="param-control">
                    <label>Intensity: <span id="intensity-display">0.7</span></label>
                    <input type="range" class="param-slider" id="intensity" min="0" max="1" step="0.1" value="0.7" disabled>
                </div>
                <div class="param-control">
                    <label>Chaos: <span id="chaos-display">0.3</span></label>
                    <input type="range" class="param-slider" id="chaos" min="0" max="1" step="0.1" value="0.3" disabled>
                </div>
                <div class="param-control">
                    <label>Speed: <span id="speed-display">1.0</span>x</label>
                    <input type="range" class="param-slider" id="speed" min="0.1" max="3" step="0.1" value="1.0" disabled>
                </div>
            </div>

            <div class="panel-section">
                <h3>üîß Actions</h3>
                <button class="control-btn" style="width: 100%; margin-bottom: 0.5rem;" onclick="downloadImage()">
                    üíæ Download Image
                </button>
                <button class="control-btn" style="width: 100%; margin-bottom: 0.5rem;" onclick="reportContent()">
                    üö© Report
                </button>
                <button class="control-btn" style="width: 100%;" onclick="goBack()">
                    ‚Üê Back to Gallery
                </button>
            </div>
        </div>
    </div>

    <script>
        // Simple WebGL renderer for the viewer
        class SimpleViewerRenderer {
            constructor(canvas) {
                this.canvas = canvas;
                this.gl = canvas.getContext('webgl2');
                this.parameters = { hue: 180, intensity: 0.7, chaos: 0.3, speed: 1.0, time: 0 };
                this.init();
            }

            init() {
                if (!this.gl) {
                    console.error('WebGL2 not supported');
                    return;
                }
                this.setupShaders();
                this.startAnimation();
                // Hide loading after 2 seconds
                setTimeout(() => {
                    document.getElementById('loading').style.display = 'none';
                }, 2000);
            }

            setupShaders() {
                const vertexSource = `#version 300 es
                    in vec2 position;
                    out vec2 uv;
                    void main() {
                        gl_Position = vec4(position, 0.0, 1.0);
                        uv = position * 0.5 + 0.5;
                    }`;

                const fragmentSource = `#version 300 es
                    precision highp float;
                    in vec2 uv;
                    out vec4 fragColor;
                    
                    uniform float time;
                    uniform float hue;
                    uniform float intensity;
                    uniform float chaos;
                    uniform float speed;
                    
                    vec3 hsv2rgb(vec3 c) {
                        vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
                        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
                        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
                    }
                    
                    void main() {
                        vec2 p = (uv - 0.5) * 2.0;
                        float t = time * speed;
                        
                        // Golden ratio based pattern
                        float phi = 1.618034;
                        float pattern = sin(p.x * phi * 8.0 + t) * sin(p.y * phi * 8.0 + t * 0.618);
                        
                        // Add some complexity
                        pattern += sin(length(p) * phi * 10.0 + t * 2.0) * chaos;
                        pattern = mix(pattern, sin(atan(p.y, p.x) * 8.0 + t), chaos * 0.5);
                        
                        // Beautiful color mapping
                        vec3 color = hsv2rgb(vec3(
                            hue / 360.0 + pattern * 0.1,
                            0.8 + chaos * 0.2,
                            intensity * (pattern * 0.3 + 0.7)
                        ));
                        
                        fragColor = vec4(color, 1.0);
                    }`;

                this.program = this.createProgram(vertexSource, fragmentSource);
                this.setupGeometry();
            }

            createProgram(vertexSource, fragmentSource) {
                const gl = this.gl;
                const vertexShader = this.createShader(gl.VERTEX_SHADER, vertexSource);
                const fragmentShader = this.createShader(gl.FRAGMENT_SHADER, fragmentSource);
                
                const program = gl.createProgram();
                gl.attachShader(program, vertexShader);
                gl.attachShader(program, fragmentShader);
                gl.linkProgram(program);
                return program;
            }

            createShader(type, source) {
                const gl = this.gl;
                const shader = gl.createShader(type);
                gl.shaderSource(shader, source);
                gl.compileShader(shader);
                return shader;
            }

            setupGeometry() {
                const vertices = new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]);
                const buffer = this.gl.createBuffer();
                this.gl.bindBuffer(this.gl.ARRAY_BUFFER, buffer);
                this.gl.bufferData(this.gl.ARRAY_BUFFER, vertices, this.gl.STATIC_DRAW);
                
                const positionLocation = this.gl.getAttribLocation(this.program, 'position');
                this.gl.enableVertexAttribArray(positionLocation);
                this.gl.vertexAttribPointer(positionLocation, 2, this.gl.FLOAT, false, 0, 0);
            }

            render() {
                const gl = this.gl;
                gl.viewport(0, 0, this.canvas.width, this.canvas.height);
                gl.clear(gl.COLOR_BUFFER_BIT);
                gl.useProgram(this.program);
                
                gl.uniform1f(gl.getUniformLocation(this.program, 'time'), this.parameters.time);
                gl.uniform1f(gl.getUniformLocation(this.program, 'hue'), this.parameters.hue);
                gl.uniform1f(gl.getUniformLocation(this.program, 'intensity'), this.parameters.intensity);
                gl.uniform1f(gl.getUniformLocation(this.program, 'chaos'), this.parameters.chaos);
                gl.uniform1f(gl.getUniformLocation(this.program, 'speed'), this.parameters.speed);
                
                gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
                this.parameters.time += 0.016;
            }

            startAnimation() {
                const animate = () => {
                    this.render();
                    requestAnimationFrame(animate);
                };
                animate();
            }
        }

        // Initialize renderer
        const canvas = document.getElementById('main-canvas');
        const renderer = new SimpleViewerRenderer(canvas);

        // Interaction functions
        let liked = false;
        let likeCount = 156;

        function toggleLike() {
            liked = !liked;
            const likeIcon = document.getElementById('like-icon');
            const likeCountEl = document.getElementById('like-count');
            
            if (liked) {
                likeIcon.textContent = '‚ù§Ô∏è';
                likeCount++;
            } else {
                likeIcon.textContent = 'ü§ç';
                likeCount--;
            }
            
            likeCountEl.textContent = likeCount.toLocaleString();
        }

        function shareCreation() {
            if (navigator.share) {
                navigator.share({
                    title: 'Check out this amazing mathematical art!',
                    text: 'Created with VIB34D - the mathematical art platform',
                    url: window.location.href
                });
            } else {
                // Fallback - copy to clipboard
                navigator.clipboard.writeText(window.location.href);
                showMessage('Link copied to clipboard!');
            }
        }

        function remixCreation() {
            const params = new URLSearchParams(window.location.search);
            const remixUrl = `index-clean.html?remix=true&hue=${renderer.parameters.hue}&intensity=${renderer.parameters.intensity}&chaos=${renderer.parameters.chaos}`;
            window.location.href = remixUrl;
        }

        function createOwn() {
            window.location.href = 'index-clean.html';
        }

        function togglePanel() {
            const panel = document.getElementById('side-panel');
            panel.classList.toggle('open');
        }

        function downloadImage() {
            const link = document.createElement('a');
            link.download = 'vib34d-creation.png';
            link.href = canvas.toDataURL();
            link.click();
        }

        function reportContent() {
            showMessage('Content reported. Thank you for helping keep VIB34D safe.');
        }

        function goBack() {
            window.history.back();
        }

        function showMessage(message) {
            const messageDiv = document.createElement('div');
            messageDiv.textContent = message;
            messageDiv.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0,0,0,0.9);
                color: white;
                padding: 1rem 2rem;
                border-radius: 10px;
                z-index: 1000;
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255,255,255,0.2);
            `;
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        // Load URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('hue')) renderer.parameters.hue = parseFloat(urlParams.get('hue'));
        if (urlParams.get('intensity')) renderer.parameters.intensity = parseFloat(urlParams.get('intensity'));
        if (urlParams.get('chaos')) renderer.parameters.chaos = parseFloat(urlParams.get('chaos'));
        if (urlParams.get('speed')) renderer.parameters.speed = parseFloat(urlParams.get('speed'));

        // Update display values
        document.getElementById('hue-display').textContent = Math.round(renderer.parameters.hue);
        document.getElementById('intensity-display').textContent = renderer.parameters.intensity.toFixed(1);
        document.getElementById('chaos-display').textContent = renderer.parameters.chaos.toFixed(1);
        document.getElementById('speed-display').textContent = renderer.parameters.speed.toFixed(1);

        // Handle resize
        function handleResize() {
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * devicePixelRatio;
            canvas.height = rect.height * devicePixelRatio;
        }

        window.addEventListener('resize', handleResize);
        handleResize();

        // Simulate view count increment
        let viewCount = 2847;
        setInterval(() => {
            if (Math.random() > 0.7) {
                viewCount += Math.floor(Math.random() * 3) + 1;
                document.getElementById('view-count').textContent = viewCount.toLocaleString();
            }
        }, 30000);

        // Close panel when clicking outside
        document.addEventListener('click', (e) => {
            const panel = document.getElementById('side-panel');
            if (!panel.contains(e.target) && !e.target.textContent.includes('Settings')) {
                panel.classList.remove('open');
            }
        });
    </script>
</body>
</html>