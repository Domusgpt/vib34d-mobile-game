<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIB34D Parallel Test Framework</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        body {
            font-family: 'Orbitron', monospace;
            background: #0a0a0a;
            color: #00ffaa;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #ff64ff;
            text-shadow: 0 0 10px #ff64ff;
            margin-bottom: 30px;
        }
        
        .test-section {
            background: rgba(0, 255, 170, 0.05);
            border: 1px solid rgba(0, 255, 170, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .test-section h2 {
            color: #00ffaa;
            margin-top: 0;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .test-card {
            background: rgba(255, 100, 255, 0.05);
            border: 1px solid rgba(255, 100, 255, 0.3);
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .test-card:hover {
            background: rgba(255, 100, 255, 0.1);
            border-color: rgba(255, 100, 255, 0.5);
            transform: translateY(-2px);
        }
        
        .test-card.running {
            background: rgba(255, 165, 0, 0.1);
            border-color: rgba(255, 165, 0, 0.5);
            animation: pulse 2s infinite;
        }
        
        .test-card.completed {
            background: rgba(0, 255, 0, 0.1);
            border-color: rgba(0, 255, 0, 0.5);
        }
        
        .test-card.failed {
            background: rgba(255, 0, 0, 0.1);
            border-color: rgba(255, 0, 0, 0.5);
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .test-card h3 {
            margin: 0 0 10px 0;
            color: #ff64ff;
            font-size: 16px;
        }
        
        .test-card p {
            margin: 0 0 10px 0;
            font-size: 12px;
            opacity: 0.8;
        }
        
        .test-approaches {
            font-size: 10px;
            color: #888;
        }
        
        .control-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid rgba(0, 255, 170, 0.3);
            border-radius: 10px;
            padding: 15px;
            min-width: 200px;
        }
        
        .control-panel button {
            background: rgba(255, 100, 255, 0.2);
            border: 1px solid #ff64ff;
            color: #ff64ff;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Orbitron', monospace;
            font-size: 12px;
            margin: 3px;
            transition: all 0.2s ease;
        }
        
        .control-panel button:hover {
            background: rgba(255, 100, 255, 0.4);
            transform: scale(1.05);
        }
        
        .control-panel button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        #results {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(0, 255, 170, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .system-status {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .system-card {
            background: rgba(0, 255, 170, 0.05);
            border: 1px solid rgba(0, 255, 170, 0.2);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .system-card.active {
            background: rgba(0, 255, 170, 0.2);
            border-color: rgba(0, 255, 170, 0.5);
        }
        
        .system-card h4 {
            margin: 0 0 5px 0;
            color: #00ffaa;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
        
        .status-indicator.ready { background: #00ff00; }
        .status-indicator.running { background: #ffaa00; animation: pulse 1s infinite; }
        .status-indicator.error { background: #ff0000; }
        .status-indicator.unknown { background: #666; }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧪 VIB34D PARALLEL TEST FRAMEWORK</h1>
        
        <div class="control-panel">
            <h3 style="margin: 0 0 15px 0; color: #00ffaa;">Test Control</h3>
            <button id="runAllTests">Run All Tests</button>
            <button id="runQuickTest">Quick Test</button>
            <button id="stopTests" disabled>Stop Tests</button>
            <button id="clearResults">Clear Results</button>
            <div style="margin-top: 15px;">
                <label style="display: block; font-size: 10px; color: #888;">Test Duration:</label>
                <select id="testDuration" style="width: 100%; background: #111; color: #00ffaa; border: 1px solid #444; font-family: 'Orbitron', monospace;">
                    <option value="3000">3 seconds (Quick)</option>
                    <option value="10000" selected>10 seconds (Standard)</option>
                    <option value="30000">30 seconds (Thorough)</option>
                    <option value="60000">60 seconds (Comprehensive)</option>
                </select>
            </div>
        </div>
        
        <div class="system-status">
            <div class="system-card" id="faceted-status">
                <h4>🔷 Faceted</h4>
                <div><span class="status-indicator unknown"></span><span id="faceted-text">Ready</span></div>
            </div>
            <div class="system-card" id="quantum-status">
                <h4>🌌 Quantum</h4>
                <div><span class="status-indicator unknown"></span><span id="quantum-text">Ready</span></div>
            </div>
            <div class="system-card" id="holographic-status">
                <h4>✨ Holographic</h4>
                <div><span class="status-indicator unknown"></span><span id="holographic-text">Ready</span></div>
            </div>
            <div class="system-card" id="polychora-status">
                <h4>🔮 Polychora</h4>
                <div><span class="status-indicator unknown"></span><span id="polychora-text">Ready</span></div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>📊 Available Test Suites</h2>
            <div class="test-grid" id="testGrid">
                <!-- Test cards will be generated here -->
            </div>
        </div>
        
        <div class="test-section">
            <h2>📋 Test Results</h2>
            <div id="results">No tests run yet. Click a test above to begin parallel testing...</div>
        </div>
    </div>

    <script type="module">
        import { ParallelTestFramework } from './src/testing/ParallelTestFramework.js';
        
        class TestInterface {
            constructor() {
                this.framework = new ParallelTestFramework();
                this.isRunning = false;
                this.currentTests = new Map();
                
                this.initializeInterface();
                this.setupEventListeners();
            }
            
            initializeInterface() {
                this.updateSystemStatus();
                this.generateTestCards();
            }
            
            generateTestCards() {
                const testGrid = document.getElementById('testGrid');
                const availableTests = this.framework.getAvailableTests();
                
                const testDescriptions = {
                    audioReactivity: {
                        title: 'Audio Reactivity Tests',
                        description: 'Test different approaches for audio reactivity across all systems',
                        approaches: 'MVEP-style, Central Coordinator, Hybrid, Isolated Processing',
                        critical: true
                    },
                    speedControl: {
                        title: 'Speed Control Tests', 
                        description: 'Test different speed parameter calculation methods',
                        approaches: 'Base Multiplier, Additive Boost, Controlled Addition, Exponential',
                        critical: true
                    },
                    mouseInteraction: {
                        title: 'Mouse Interaction Tests',
                        description: 'Test different mouse interaction intensity levels',
                        approaches: 'Full, Half, Quarter, Adaptive Intensity',
                        critical: false
                    },
                    parameterSync: {
                        title: 'Parameter Sync Tests',
                        description: 'Test different parameter synchronization methods',
                        approaches: 'Immediate, Smooth Transition, Batch, Debounced',
                        critical: false
                    }
                };
                
                testGrid.innerHTML = '';
                
                availableTests.forEach(testType => {
                    const desc = testDescriptions[testType] || { title: testType, description: 'Unknown test', approaches: '' };
                    
                    const card = document.createElement('div');
                    card.className = 'test-card';
                    card.id = `test-${testType}`;
                    card.innerHTML = `
                        <h3>${desc.title} ${desc.critical ? '⚡' : ''}</h3>
                        <p>${desc.description}</p>
                        <div class="test-approaches">${desc.approaches}</div>
                    `;
                    
                    card.addEventListener('click', () => this.runIndividualTest(testType));
                    testGrid.appendChild(card);
                });
            }
            
            setupEventListeners() {
                document.getElementById('runAllTests').addEventListener('click', () => this.runAllTests());
                document.getElementById('runQuickTest').addEventListener('click', () => this.runQuickTests());
                document.getElementById('stopTests').addEventListener('click', () => this.stopTests());
                document.getElementById('clearResults').addEventListener('click', () => this.clearResults());
            }
            
            updateSystemStatus() {
                const systems = ['faceted', 'quantum', 'holographic', 'polychora'];
                
                systems.forEach(system => {
                    const indicator = document.querySelector(`#${system}-status .status-indicator`);
                    const text = document.getElementById(`${system}-text`);
                    
                    // Check if system is available
                    if (window[`${system}System`] || window[`${system}Engine`]) {
                        indicator.className = 'status-indicator ready';
                        text.textContent = 'Ready';
                    } else {
                        indicator.className = 'status-indicator unknown';
                        text.textContent = 'Unknown';
                    }
                });
            }
            
            async runIndividualTest(testType) {
                if (this.isRunning) return;
                
                const card = document.getElementById(`test-${testType}`);
                card.className = 'test-card running';
                
                this.setRunning(true);
                this.logResult(`🚀 Starting ${testType.toUpperCase()} parallel tests...`);
                
                try {
                    const duration = parseInt(document.getElementById('testDuration').value);
                    const result = await this.framework.runParallelTests(testType, duration);
                    
                    card.className = 'test-card completed';
                    this.displayTestResult(testType, result);
                    
                } catch (error) {
                    card.className = 'test-card failed';
                    this.logResult(`❌ Test failed: ${error.message}`);
                } finally {
                    this.setRunning(false);
                }
            }
            
            async runAllTests() {
                if (this.isRunning) return;
                
                this.setRunning(true);
                this.logResult('🚀 Starting comprehensive parallel test suite...');
                
                const availableTests = this.framework.getAvailableTests();
                const duration = parseInt(document.getElementById('testDuration').value);
                
                for (const testType of availableTests) {
                    this.logResult(`\n📊 Testing: ${testType.toUpperCase()}`);
                    
                    try {
                        const result = await this.framework.runParallelTests(testType, duration);
                        this.displayTestResult(testType, result);
                        
                        // Brief pause between test suites
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        
                    } catch (error) {
                        this.logResult(`❌ ${testType} failed: ${error.message}`);
                    }
                }
                
                this.logResult('\\n🏁 All parallel tests completed!');
                this.setRunning(false);
            }
            
            async runQuickTests() {
                if (this.isRunning) return;
                
                this.setRunning(true);
                this.logResult('⚡ Running quick parallel tests (critical issues only)...');
                
                const criticalTests = ['audioReactivity', 'speedControl'];
                
                for (const testType of criticalTests) {
                    try {
                        const result = await this.framework.quickTest(testType);
                        this.displayTestResult(testType, result);
                    } catch (error) {
                        this.logResult(`❌ ${testType} failed: ${error.message}`);
                    }
                }
                
                this.setRunning(false);
            }
            
            stopTests() {
                // Implementation would depend on framework's abort capabilities
                this.logResult('🛑 Test stop requested (implementation pending)...');
            }
            
            displayTestResult(testType, result) {
                if (!result) {
                    this.logResult(`❌ No results for ${testType}`);
                    return;
                }
                
                this.logResult(`\\n📊 RESULTS: ${testType.toUpperCase()}`);
                this.logResult(`Success Rate: ${result.summary.successRate}`);
                this.logResult(`Best Approach: ${result.summary.bestApproach}`);
                this.logResult(`Best Score: ${result.summary.bestScore}`);
                
                if (result.rankings.length > 0) {
                    this.logResult('\\n🏆 Top Approaches:');
                    result.rankings.slice(0, 3).forEach((ranking, index) => {
                        const score = (ranking.overallScore * 100).toFixed(1);
                        this.logResult(`${index + 1}. ${ranking.approach}: ${score}%`);
                    });
                }
                
                if (result.recommendations.length > 0) {
                    this.logResult('\\n💡 Recommendations:');
                    result.recommendations.forEach(rec => {
                        this.logResult(`• ${rec}`);
                    });
                }
                
                this.logResult(`\\n${'='.repeat(50)}`);
            }
            
            setRunning(running) {
                this.isRunning = running;
                document.getElementById('runAllTests').disabled = running;
                document.getElementById('runQuickTest').disabled = running;
                document.getElementById('stopTests').disabled = !running;
                
                // Update system status indicators
                const indicators = document.querySelectorAll('.status-indicator');
                indicators.forEach(indicator => {
                    if (running) {
                        indicator.className = 'status-indicator running';
                    } else {
                        indicator.className = 'status-indicator ready';
                    }
                });
            }
            
            logResult(message) {
                const results = document.getElementById('results');
                const timestamp = new Date().toLocaleTimeString();
                results.textContent += `[${timestamp}] ${message}\\n`;
                results.scrollTop = results.scrollHeight;
            }
            
            clearResults() {
                document.getElementById('results').textContent = 'Results cleared. Ready for new tests...';
                
                // Reset test cards
                const testCards = document.querySelectorAll('.test-card');
                testCards.forEach(card => {
                    card.className = 'test-card';
                });
            }
        }
        
        // Initialize the test interface when page loads
        window.addEventListener('DOMContentLoaded', () => {
            new TestInterface();
        });
        
        // Export for global access
        window.TestInterface = TestInterface;
    </script>
</body>
</html>